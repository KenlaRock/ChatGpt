<!DOCTYPE html>
<html lang="sv" data-theme="dark">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Data Viewer & Converter â€” v2.2 Â· M4</title>
    <!--
      Uppdaterad CSP fÃ¶r att stÃ¶dja blob: workers och offline-funktion pÃ¥
      Android/Chrome via file://. Vi tillÃ¥ter blob: fÃ¶r script-src,
      connect-src och worker-src och behÃ¥ller strikt default-src. Detta
      mÃ¶jliggÃ¶r att webblÃ¤saren kan skapa Web Workers Ã¤ven nÃ¤r appen kÃ¶rs
      lokalt utan server och nÃ¤r mobila sÃ¤kerhetspolicys annars skulle
      blockera blob-ursprung.
    -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self' blob: data:; img-src 'self' blob: data:; style-src 'self' 'unsafe-inline'; font-src 'self' data:; script-src 'self' 'unsafe-inline' blob:; connect-src 'self' blob:; worker-src 'self' blob:; object-src 'none'; base-uri 'none'; form-action 'self';">
<link rel="stylesheet" href="app.css">
</head>
<body>
<header role="banner">
  <!-- Off-canvas menyknapp fÃ¶r mobila vyer; dÃ¶ljs via CSS pÃ¥ desktop -->
  <button id="btnMenu" class="btn" aria-controls="sidebar" aria-expanded="false" style="display:none;">â˜° Meny</button>
  <h1>Data Viewer & Converter â€” v2.2 Â· Final</h1>
  <div class="toolbar" role="toolbar" aria-label="VerktygsfÃ¤lt">
    <label class="btn" for="fileInput" title="Ã–ppna fil (Ctrl+O)">ðŸ“‚ Ã–ppna</label>
    <input id="fileInput" type="file" accept=".json,.xml,.csv,.yaml,.yml,.md,.markdown,.html,.css,.js,.txt"/>
    <button id="btnPaste" class="btn" title="Klistra in (Ctrl+V)">ðŸ“‹ Klistra in</button>
    <button id="btnSample" class="btn" title="Ladda exempeldata">ðŸ§ª Exempel</button>
    <span class="badge" id="badgeFormat">â€”</span>
    <span class="badge" id="badgeNodes">0 noder</span>
    <span class="badge" id="badgeSize">0 B</span>
    <span class="badge" id="badgeStatus">Redo</span>
  </div>
</header>
  <!-- Backdrop fÃ¶r off-canvas sidopanel pÃ¥ mobil -->
  <div id="backdrop"></div>
<div id="app" role="main">
  <aside id="sidebar" aria-label="Sidopanel">
    <div class="card">
      <strong>Vy</strong>
      <div role="group" aria-label="VyvÃ¤ljare" style="margin-top:.5rem;display:grid;gap:.5rem">
        <button class="btn" data-view="raw" aria-pressed="true">Raw</button>
        <button class="btn" data-view="tree">TrÃ¤d</button>
        <button class="btn" data-view="outline">Outline</button>
        <button class="btn" data-view="table">Tabell</button>
        <button class="btn" data-view="mindmap">Mindmap</button>
      </div>
    </div>
    <div class="card">
      <strong>Filter</strong>
      <input id="txtSearch" class="input" type="search" placeholder="SÃ¶k (regex stÃ¶ds)"/>
      <div style="display:grid;gap:.35rem;margin-top:.5rem">
        <button class="btn preset" data-preset="empty">Tomma vÃ¤rden</button>
        <button class="btn preset" data-preset="dupes">Dubbletter</button>
        <button class="btn preset" data-preset="errors">Valideringsfel</button>
      </div>
    </div>
    <div class="card">
      <strong>Edit</strong>
      <label><input type="checkbox" id="chkEdit"> Aktivera redigering</label>
      <div id="editTools" class="small">
        <p>Markera en cell eller ett fÃ¤lt fÃ¶r inline-edit. Ã„ndringar hamnar i undo/redo-stacken.</p>
      </div>
    </div>
    <div class="card">
      <strong>Schema-validering (minimal)</strong>
      <textarea id="schemaBox" rows="6" placeholder='Klistra JSON Schema'></textarea>
      <div style="display:flex;gap:.5rem;margin-top:.5rem">
        <button id="btnValidate" class="btn">Validera</button>
        <span id="valBadge" class="badge">Ingen kÃ¶rning</span>
      </div>
    </div>
    <div class="card">
      <strong>Konvertera & Exportera</strong>
      <div style="display:grid;gap:.35rem;margin-top:.5rem">
        <button class="btn convert" data-format="json">Konv. JSON</button>
        <button class="btn convert" data-format="xml">Konv. XML</button>
        <button class="btn convert" data-format="yaml">Konv. YAML</button>
        <button class="btn convert" data-format="csv">Konv. CSV</button>
        <button class="btn convert" data-format="md">Konv. MD</button>
        <button class="btn convert" data-format="html">Konv. HTML</button>
        <button class="btn export" data-format="json">Exportera JSON</button>
        <button class="btn export" data-format="xml">Exportera XML</button>
        <button class="btn export" data-format="yaml">Exportera YAML</button>
        <button class="btn export" data-format="csv">Exportera CSV</button>
        <button class="btn export" data-format="md">Exportera MD</button>
        <button class="btn export" data-format="html">Exportera HTML</button>
        <button class="btn export" data-format="htmlsingle">Exportera HTML (single)</button>
        <button class="btn export" data-format="pdf">Exportera PDF</button>
      </div>
      <label class="small"><input type="checkbox" id="chkForce"> Force export</label>
      <div id="exportMsg" class="small" style="margin-top:.3rem"></div>
    </div>
    <div class="card">
      <strong>Snapshots</strong>
      <div style="display:flex;gap:.5rem;margin:.5rem 0">
        <button id="btnSaveSnap" class="btn">Spara</button>
        <button id="btnLoadSnap" class="btn">Ã–ppna</button>
      </div>
      <div id="snapList" class="kv" aria-live="polite"></div>
    </div>
    <div class="card">
      <strong>Undo/Redo</strong>
      <div style="display:flex;gap:.5rem;margin-top:.5rem">
        <button id="btnUndo" class="btn" title="Ctrl+Z">â†¶ Undo</button>
        <button id="btnRedo" class="btn" title="Ctrl+Y">â†· Redo</button>
        <span class="badge" id="badgeUR">0/0</span>
      </div>
    </div>
    <footer class="small">Bygg: v2.2 Â· Final Â· 2025-09-12T00:00:00Z</footer>
  </aside>
  <section id="main">
    <div class="panel" id="dropHost">
      <div id="dropzone" class="dropzone" tabindex="0" role="region" aria-label="SlÃ¤pp fil hÃ¤r">
        SlÃ¤pp fil hÃ¤r eller anvÃ¤nd <strong>Ã–ppna</strong> / <strong>Klistra in</strong>.
      </div>
      <div id="views" style="margin-top:.75rem;min-height:50vh">
        <section id="view-raw"><h3>Raw</h3><pre id="raw" class="code"></pre></section>
        <section id="view-tree" class="hidden"><h3>TrÃ¤d</h3><div id="tree" class="tree"></div></section>
        <section id="view-outline" class="hidden"><h3>Outline</h3><div id="outline" class="outline"></div></section>
        <section id="view-table" class="hidden"><h3>Tabell</h3><div id="tableHost"></div></section>
        <section id="view-mindmap" class="hidden"><h3>Mindmap</h3><canvas id="mind" width="1200" height="800" style="max-width:100%;border:1px solid var(--border);border-radius:10px;background:#0f1621"></canvas><div class="small">Drag fÃ¶r att panorera. Dubbelklick fÃ¶r att centrera.</div></section>
      </div>
    </div>
    <div id="statusbar" role="status" aria-live="polite">
      <span>Tips: <kbd>Ctrl+O</kbd> Ã¶ppna, <kbd>Ctrl+V</kbd> klistra in, <kbd>/</kbd> sÃ¶k. VÃ¤xla vy i sidopanelen.</span>
      <span id="perfBanner" style="color: var(--yellow); font-weight: bold;"></span>
    </div>
  </section>
</div>
<script src="app.js"></script>
</body>
</html>
